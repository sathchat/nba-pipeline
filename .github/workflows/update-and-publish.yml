name: Update NBA dataset and publish to Kaggle

on:
  schedule:
    - cron: "0 12 * * *"    # 12:00 UTC daily (8:00 AM America/New_York)
  workflow_dispatch: {}

jobs:
  run:
    runs-on: ubuntu-latest
    permissions:
      contents: read

    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: Install Python dependencies
        run: |
          python -m pip install -U pip
          pip install -r requirements.txt
          pip install kaggle

      - name: Seed empty CSVs if missing (avoids first-run Kaggle errors)
        run: |
          python - <<'PY'
          import os, csv
          os.makedirs('export', exist_ok=True)
          def ensure(path, cols):
              if not os.path.exists(path):
                  with open(path,'w',newline='',encoding='utf-8') as f:
                      csv.writer(f).writerow(cols)
          games_cols = ["gameId","gameCode","gameDateEt","gameStatusT]()_
